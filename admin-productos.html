<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos - Halegría</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 p-6">
    <div class="max-w-md mx-auto">
        <button onclick="window.location.href='admin.html'" class="mb-4 text-blue-600 font-bold">← Volver al Panel</button>
        <div class="bg-white p-8 rounded-3xl shadow-xl">
            <h2 class="text-2xl font-black mb-6">Nueva Paleta</h2>
            <input type="text" id="n" placeholder="Nombre" class="w-full p-4 mb-3 bg-slate-100 rounded-xl border-none">
            <input type="number" id="p" placeholder="Precio" class="w-full p-4 mb-3 bg-slate-100 rounded-xl border-none">
            <input type="text" id="f" placeholder="Link de foto (opcional)" class="w-full p-4 mb-6 bg-slate-100 rounded-xl border-none">
            <button onclick="enviar()" id="btn" class="w-full bg-blue-600 text-white py-4 rounded-xl font-black">GUARDAR AHORA</button>
        </div>
    </div>

    <script>
        async function enviar() {
            const b = document.getElementById('btn');
            b.innerText = "Conectando...";
            b.disabled = true;

            const objeto = {
                nombre: document.getElementById('n').value,
                precio: parseInt(document.getElementById('p').value),
                imagen: document.getElementById('f').value || "https://via.placeholder.com/150"
            };

            try {
                const r = await fetch("https://pvedrhxzfhxgosuecczz.supabase.co/rest/v1/productos", {
                    method: 'POST',
                    headers: { 
                        "apikey": "sb_publishable_3KUGa57mxOhfXJxZp7BlIg_pfvBWlsn", 
                        "Authorization": "Bearer sb_publishable_3KUGa57mxOhfXJxZp7BlIg_pfvBWlsn",
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(objeto)
                });

                if(r.ok) {
                    alert("¡LOGRADO! El producto se guardó.");
                    window.location.href = 'admin.html';
                } else {
                    const err = await r.json();
                    alert("Error de base de datos: " + err.message);
                }
            } catch (e) {
                alert("Error de Internet o URL incorrecta");
            } finally {
                b.innerText = "GUARDAR AHORA";
                b.disabled = false;
            }
        }
    </script>
</body>
</html>
